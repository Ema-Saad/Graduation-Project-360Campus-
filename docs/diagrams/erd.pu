@startuml

entity Staff {
    id: int 
    name: varchar
    email: varchar 
    role: varchar
    college: varchar
    department: varchar
}

entity Student {
    id: int 
    name: varchar
    email: varchar 
    college: varchar
    department: varchar
}

entity Course {
    id: int  
    title: varchar 
    description: text 
    admin_id: int 
    prerequisite_id: int 
    created_at: datetime 
    updated_at: datetime 
}

entity Material {
    id: int  
    course_id: int 
    year: int 
    type: varchar 
    file_path: varchar 
    description: text 
}

entity Lecture {
  id int  
  course_id int 
  title varchar 
  date datetime 
  duration int 
}

entity Lab {
  id int  
  course_id int 
  title varchar 
  date datetime 
  duration int 
}

entity Tutorial {
  id int  
  course_id int 
  title varchar 
  date datetime 
  duration int 
}

entity Assignment {
  id int  
  course_id int 
  title varchar 
  description text 
  due_date datetime 
  submitted boolean 
}

entity Absence {
  id int 
  student_id int 
  course_id int 
  date datetime
  status varchar 
}

entity Event {
  id int 
  title varchar
  description text
  date datetime
  created_by int 
}

entity Enrollment {
  id int 
  student_id int 
  course_id int 
  enrolled_at datetime
}

entity Chatroom {
  id int 
  course_id int 
  title varchar 
  created_at datetime
}

entity Message {
  id int 
  chatroom_id int 
  sender_id int 
  content text
  sent_at datetime
}


entity Submission {
  id int 
  assignment_id int 
  student_id int 
  file_path varchar
  submitted_at datetime
}


entity EventRegistration {
  event_id int 
  student_id int 
  registered_at datetime
}

Table StudentPerformance {
    performance_id int [pk]
    student_id int [ref: > Student.id]
    course_id int [ref: > Course.id]
    grade float
    feedback text
    created_at timestamp [default: `current_timestamp`]
}

Table StaffPerformance {
    performance_id int [pk]
    staff_id int [ref: > Staff.id]
    course_id int [ref: > Course.id]
    role varchar(10) // Professor, TA
    evaluation_score float // e.g., based on student feedback or other metrics
    feedback text
    created_at timestamp [default: `current_timestamp`]
}

//Add a note to clarify reference
//Note: 'generated_by_id' references 'student_id' in 'Student' if 'generated_by_type' is 'Student'
//otherwise it references 'staff_id' in 'Staff'. Ensure application logic enforces this relationship.

Table Report {
  report_id int [pk]
  title varchar
  content text
  generated_by_type varchar // Either 'Student' or 'Staff'
  generated_by_id int [ref: > Staff.id, ref: > Student.id]// Refers to either student_id or staff_id based on type
  generated_date datetime
  data json

}

Table GraduationProject {
    project_id int [pk]
    project_name varchar(100)
    description text
    student_id INT [ref: < Student.id]
    supervised_by int [ref: > Staff.id]
    final_grade varchar
    created_at timestamp [default: `current_timestamp`]
}

Table Timetable {
    timetable_id int [pk]
    course_id int [ref: < Course.id]
    instructor_id int [ref: < Staff.id]
    room_id int [ref: < Rooms.room_id]
    timeslot_id int [ref: < Timeslots.timeslot_id]
    section_id int
    created_at timestamp [default: `current_timestamp`]
}

Table Timeslots {
    timeslot_id int [pk]
    start_time time
    end_time time
    day varchar(10) // Monday, Tuesday, etc.
}

Table Rooms {
    room_id int [pk]
    room_name varchar(50)
    capacity int
    equipment json
}

skinparam linetype ortho

Course }o-|| Course: prerequiste 
Classroom }o---o{ Student
Classroom }o---|{ Instructor
Enrollment }o--|| Instructor
Enrollment }o-----|| Course
AbsenseRecord }o---|| Student
AbsenseRecord }o---|| Enrollment
Assignment }o----|| Course
Tutorial }|----|| Course
Lab }|----|| Course
Lecture }|---|| Course
Material }o---|| Course
Staff ||---o{ Material
Message }o---|| Student
Message }o---|| Chatroom
Event }o----|| EventRegistration
Student }o---|| EventRegistration
Attendance ||---|| Enrollment

Student ||---o{ Submission
Assignment ||---o{ Submission
Enrollment ||---o{ Submission

@enduml
